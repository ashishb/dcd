doc1

a
b
c

doc2

z
a
b
c
z


 123456
1 X
2  X
3   X


doc1

a
b
c

doc2

x
a
b
y
c
z


 123456
1 X
2  X
3    X


options needed

1 filter by extension
2 filter out matches of the first x lines
3 filter 


1600 MB for about 100,000,000 million lines